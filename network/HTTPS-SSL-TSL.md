# HTTPS-SSL-TSL

HTTPS是基于TCP+SSL(TSL)完成的,TSL是SSL的升级版本

## TLS协议wikipedia

TLS(传输层安全协议)协议主要旨在提供两个或更多通信计算机应用程序之间的隐私和数据完整性。当通过TLS保护时，客户端（例如，Web浏览器）和服务器（例如，wikipedia.org）之间的连接应具有以下一个或多个属性：

* 连接是私有的（或安全的），因为对称加密用于加密传输的数据。key为这个对称加密唯一地生成针对每个连接，并基于一个共享秘密开始协商会话。服务器和客户端在传输数据的第一个字节之前协商要使用的加密算法和加密密钥的详细信息。共享秘密的协商是安全的（窃听者无法获得协商的秘密 并且即使是将自己置于连接中间的攻击者也无法获得且可靠（攻击者无法在未经检测到的情况下修改协商期间的通信）。
* 可以使用公钥加密来验证通信方的身份。该认证可以是可选的，但通常需要至少一方（通常是服务器）。
* 该连接是可靠的，因为发送的每个消息包括使用消息认证码的消息完整性检查，以防止在传输期间未检测到的丢失或数据的改变。

在握手期间，客户端和服务器就用于建立连接安全性的各种参数达成一致：

* 当客户端连接到启用TLS的服务器请求安全连接并且客户端提供受支持的密码套件列表（密码和散列函数）时，握手开始。
* 从该列表中，服务器选择它也支持的密码和散列函数，并通知客户端该决定。
* 然后，服务器通常以数字证书的形式提供标识。证书包含服务器名称，证明证书真实性的可信证书颁发机构（CA）以及服务器的公共加密密钥。
* 客户在继续之前确认证书的有效性。
* 要生成用于安全连接的会话密钥，客户端要么：
  * **使用服务器的公钥加密随机数**，并将结果发送到服务器（**只有服务器能够使用其私钥解密**）; 然后，双方使用随机数生成唯一的会话密钥，用于在会话期间对数据进行后续加密和解密
  * 使用Diffie-Hellman密钥交换来安全地生成用于加密和解密的随机且唯一的会话密钥，该密钥具有前向保密的附加属性：如果将来公开服务器的私钥，则它不能用于解密当前会话，即使会话被第三方截获并记录。
* 这结束了握手并开始安全连接，使用会话密钥加密和解密，直到连接关闭。如果上述任何一个步骤失败，则TLS握手失败并且不会创建连接。

## SSL证书如何工作

基本原则是当您在服务器上安装SSL证书并且浏览器连接到它时，SSL证书的存在会触发SSL（或TLS）协议，该协议将加密服务器和浏览器之间（或之间）发送的信息。SSL直接在传输控制协议（TCP）之上运行，有效地用作安全毯。它允许更高的协议层保持不变，同时仍提供安全连接。因此，在SSL层下面，其他协议层可以正常运行。核心就是TCP层的数据就无法使用常规的方式转成http报文或其他应该报文了,因为黑客没有密钥,插一句,客户端与服务器通信之间会随机产生一个数字作为对称加密的元素

如果正确使用SSL证书，攻击者将能够看到连接的IP和端口以及发送的大致数据。他们可能能够终止连接，但服务器和用户都能够告诉他们已经完成了第三方的连接。但是，他们无法拦截任何信息，这使得它基本上是一个无效的步骤。黑客可能能够确定用户连接到哪个主机名，但关键的是，不是URL的其余部分。由于连接已加密，因此重要信息仍然是安全的。

1. 建立TCP连接后，SSL开始工作，启动所谓的SSL握手。(上述TLS协议说明了握手过程)
2. 服务器将其证书与许多规范一起发送给用户（包括使用哪种版本的SSL / TLS以及使用哪种加密方法等）。
3. 然后，用户检查证书的有效性，并选择双方都可以支持的最高级别的加密，并使用这些方法启动安全会话。有许多方法可供选择，具有各种优势 - 它们被称为密码套件。
4. 为了保证所有传输消息的完整性和真实性，SSL和TLS协议还包括使用消息认证码（MAC）的认证过程。所有这些听起来既冗长又复杂，但实际上它几乎是瞬间完成的。
